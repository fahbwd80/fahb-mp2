'use strict';mix_d("VSEDistributionCards__vse-vw-dp-card:vse-vw-dp-card__Qx1I_HSf","exports tslib @p/A @c/scoped-dom @c/weblabs @c/logger @c/metrics @p/a-modal @c/aui-untrusted-ajax @c/navigation @c/aui-carousel @c/browser-window @c/aui-utils".split(" "),function(sa,B,Ra,Sa,Ta,Ua,ca,Va,Wa,Xa,Ya,Za,$a){function x(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}var c=x(Ra),H=x(Sa),ab=x(Ta),bb=x(Ua),cb=x(Va),db=x(Wa),ta=x(Xa),eb=x(Ya),O=x(Za),fb=x($a),ua,y=function(a){var b=ua;Object.keys(a).length<
b.requiredNumOfFields&&ca.count("invalidNumOfFields-"+b.producerId,1);a=JSON.stringify(a).replace(/\\\\/g,"");ca.event(JSON.parse(a),b.producerId,b.schemaId,{ssd:!1})},gb=function(a){return function(b){return c["default"].$.extend({eventSource:a.eventSource,placementContext:a.placementContext,clientId:a.clientId,timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:"0",videoAsin:"",videoAsinList:a.videoAsinList||"",rankingStrategy:a.rankingStrategy||"",creativeId:a.creativeId,stringPayload:a.stringPayload||
""},b)}},hb=function(){return function(a,b,e){var g=this;this.map=[];this.onHorizontalIntersectionObserved=function(h){h.forEach(function(k){var l=g.childElems.indexOf(k.target);g.map=k.isIntersecting?B.__spread(g.map,[l]):g.map.filter(function(f){return f!==l});g.intersectingTargetsIndexes=g.map.sort(function(f,n){return f-n})})};this.onViewportIntersectionObserved=function(h){h[0].isIntersecting&&g.callback()};this.getElementsWhichAreInViewPort=function(){return g.intersectingTargetsIndexes};void 0===
a&&(a=null);this.callback=e;this.parentEle=a;this.childElems=Array.from(document.querySelectorAll(b));this.optionsForHorizontalIntersection={root:this.parentEle,rootMargin:"0px",threshold:.85};this.optionsForViewportIntersection={root:null,rootMargin:"0%",threshold:1};this.horizontalIntersectionObserver=new IntersectionObserver(this.onHorizontalIntersectionObserved,this.optionsForHorizontalIntersection);this.viewportIntersectionObserver=new IntersectionObserver(this.onViewportIntersectionObserved,
this.optionsForViewportIntersection);this.childElems.forEach(function(h){g.horizontalIntersectionObserver.observe(h)});this.viewportIntersectionObserver.observe(a)}}(),d={pageType:"",clientPrefix:"",deviceType:"",placement:"",metricsPlacement:"",cardId:"",creativeId:"",requester:"",buildCsmPayload:function(a){},enableMultipleImpressions:!1,clientName:"",isIvxOpen:!1},q=function(a,b){void 0===b&&(b=1);try{ca.count("vse:csm:cards:"+d.clientPrefix+":"+a,b)}catch(e){v("failed to post CSM metric","ERROR")}},
F=function(a,b){void 0===b&&(b=1);q(a+":"+d.deviceType,b)},v=function(a,b){bb["default"].log("VSEWidgetCards: "+a+". Client prefix: "+d.clientPrefix+", Page type: "+d.pageType,b,"VSEDistributionCards")},wa=function(a,b,e){var g,h;try{if(c["default"].$("."+d.cardId).length){var k=!1,l=b.map(function(m){return m.contentId}).join(","),f=b.filter(function(m){return""!==m.metadata.rankingStrategy}).map(function(m){return m.metadata.rankingStrategy}).join(","),n=d.buildCsmPayload({eventName:d.clientPrefix+
":cardWidgetRendered",intPayload:1,videoAsinList:l,rankingStrategy:f});y(n);q("cardWidgetRendered",1);var r=function(){c["default"].delay(function(){var m=z.getElementsWhichAreInViewPort();if(m){var p=b.filter(function(C,I){return m.includes(I)});ib(p)}},500)},t=function(){for(var m=e.carouselItemClassName,p=0;p<b.length;p++)if(!b[p].impressionRecorded){var C=c["default"].$("."+d.cardId+" ."+m+":nth-child("+(p+1)+")");if(c["default"].onScreen(C,0))va(b,p),jb(C,b[p]),b[p].impressionRecorded=!0;else break}},
u=function(){if(k)c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,u);else{var m=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetScrolledInView",intPayload:1,videoAsinList:l,rankingStrategy:f}),p=c["default"].$("."+d.cardId+" ."+e.carouselItemClassName).first();p&&c["default"].onScreen(p,0)&&(y(m),m=c["default"].now()-a,q("cardWidgetScrolledInViewTime",m),F("cardWidgetScrolledInView"),k=!0,t())}};if(d.enableMultipleImpressions){var J=null===(h=null===(g=document.querySelector("."+
e.carouselItemClassName))||void 0===g?void 0:g.parentElement)||void 0===h?void 0:h.parentElement;var z=new hb(J,"."+e.carouselItemClassName,function(){var m=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetScrolledInView",intPayload:1,videoAsinList:l,rankingStrategy:f});y(m);m=c["default"].now()-a;q("cardWidgetScrolledInViewTime",m);F("cardWidgetScrolledInView");r()})}else u(),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,u);c["default"].on("vse:"+d.clientPrefix+":searchform:focus",
function(){var m=d.buildCsmPayload({eventName:d.clientPrefix+":serchFormFocus",intPayload:1,videoAsinList:l,rankingStrategy:f});y(m)});e.widgetMetricsHandler(d.enableMultipleImpressions?r:t,function(m){var p=d.buildCsmPayload({eventName:d.clientPrefix+":"+m+":paginationButtonClicked",intPayload:1});q(m+":paginationButtonClicked",1);y(p)})}}catch(m){v("Error occurred while emitting widget metrics "+m,"ERROR"),q("widgetMetricsEmissionError")}},jb=function(a,b){try{var e=a.find("[data-pfoasin!=''][data-pfoasin]");
c["default"].each(e,function(g,h){g=g.getAttribute("data-pfoasin");h=d.buildCsmPayload({eventName:d.clientPrefix+":productElementImpression",intPayload:h,videoAsin:b.contentId,stringPayload:g});y(h)})}catch(g){v("Unable to log pfo render metric "+b,"WARN")}},ib=function(a){for(var b=0;b<a.length;b++)va(a,b)},va=function(a,b){a=d.buildCsmPayload({eventName:d.clientPrefix+":thumbnailImpression",intPayload:b,videoAsin:a[b].contentId,rankingStrategy:a[b].metadata.rankingStrategy});y(a)},kb=function(a,
b){var e=[];a=a.split(",");0<a.length&&a.forEach(function(g){g=g.split(":");1<g.length&&e.push({name:g[0],assignment:g[1],ignoreForG2S2Key:b})});return e},da=function(a,b,e,g,h){void 0===h&&(h=3);h--;db["default"].post(a,{accepts:"*/*",contentType:"application/json;charset=UTF-8",timeout:5E3},b).then(function(k){e(k)}).catch(function(k){0===k.statusCode&&v("Request has failed with unknown status code. Payload: "+JSON.stringify(b),"ERROR");0<h?da(a,b,e,g,h):g(k)})},lb=function(a,b){a="/gp/mobile/tag/?ref=vse_cards_ingress"+
a+b.replace("/?_encoding=UTF8","");da(a,{},function(){},function(){})},mb=function(a,b,e,g,h,k){void 0===k&&(k=!0);var l=a.map(function(f){delete f.htmlEl;return f});b||(b=xa(a[0],{}));a=[];e.weblabContext&&(a=kb(e.weblabContext,!0));da(e.nilgiriEndpoint,{requester:d.requester,clientPrefix:d.clientPrefix,page:d.pageType,placement:d.placement,device:d.deviceType,metadata:{id:"vse-video-widget-card-"+d.clientPrefix,celQueryStringParam:e.celQueryStringParam,requestHasVideoData:"true"},videoDataList:k?
l:void 0,video:{contentID:b.contentId,contentIDType:"VIDEO_ID",videoURL:b.videoUrl,imageURL:b.imageUrl,vendorCode:b.vendorCode,vendorTrackingId:b.vendorTrackingId,videoReferenceId:b.videoReferenceId,videoTitle:b.title},marketplaceID:e.marketplaceId,locale:e.locale,product:{contentID:b.productAsin,contentIDType:"ASIN",parentContentID:b.parentAsin,parentContentIDType:"ASIN"},creativeId:d.creativeId,weblabContext:a},g,h)},xa=function(a,b){var e=a.productAsin;e||c["default"].objectIsEmpty(a.metadata.relatedProductsAsins)||
(e=a.metadata.relatedProductsAsins.split(",")[0]);var g=a.contentId,h=a.metadata.title,k=a.metadata.vendorName,l=a.metadata.vendorCode,f=a.metadata.entityId,n=a.metadata.entityType,r=a.metadata.fullReviewLink,t=a.metadata.title,u=a.metadata.videoURL,J=a.metadata.formattedDuration,z=a.metadata.videoImageUrl,m=a.parentAsin,p="vse-cards-ingress"+a.index,C=a.metadata.relatedProductsAsins,I=a.metadata.vendorTrackingId,S=a.metadata.referenceId,T=a.index,G=a.metadata.closedCaptions,ya=[];if(G&&(G=G.split(","),
0===G.length%2))for(var U=0;U<G.length;U+=2)void 0!==G[U+1]&&ya.push({locale:G[U],url:G[U+1]});b={contentId:g,title:h,vendorName:k,vendorCode:l,entityId:f,entityType:n,referenceUrl:r,referenceLinkTitle:t,videoUrl:u,duration:J,imageUrl:z,videoVoteContainer:{},productAsin:e,parentAsin:m,refTag:p,relatedProducts:C,vendorTrackingId:I,videoReferenceId:S,index:T,$el:b,closedCaptions:ya,videoDetailPageLink:a.metadata.videoDetailPageLink,impressionRecorded:a.impressionRecorded,lastPlayingTimestamp:a.lastPlayingTimestamp,
htmlEl:a.htmlEl,rankingStrategy:a.metadata.rankingStrategy,aciContentId:a.metadata.aciContentId,videoMimeType:a.metadata.videoMimeType,profileLink:a.metadata.profileLink,profileImageUrl:a.metadata.profileImageUrl,source:""===a.metadata.source?"VSE":a.metadata.source,highlightedAsin:a.metadata.highlightedAsin};"true"===a.metadata.isSponsoredBrandVideo&&(g={adFeedbackUrl:a.metadata.adFeedbackUrl||"",clickTrackerUrl:a.metadata.clickTrackerUrl||"",instrumentationPixelUrl:a.metadata.instrumentationPixelUrl||
"",trackingPixelUrl:a.metadata.trackingPixelUrl||"",linkUrl:a.metadata.linkUrl||""},b=B.__assign(B.__assign({},b),{sponsoredBrandVideoMetadata:g,isSponsoredBrandVideo:a.metadata.isSponsoredBrandVideo}));return b},ea=function(a,b,e){var g=[];[].forEach.call(a,function(h,k){var l=h.dataset.asin,f=h.dataset;if(l){l={contentId:l,productAsin:f.productAsin||"",parentAsin:f.parentAsin||"",metadata:{videoImageUrl:f.videoImageUrlUnchanged||f.videoImageUrl||"",videoURL:f.videoUrl||f.videoURL||"",title:f.title||
"",formattedDuration:f.formattedDuration||"",vendorName:f.vendorName||"",vendorCode:f.vendorCode||"",referenceId:f.referenceId||"",fullReviewLink:f.referenceUrl||"",videoDetailPageLink:f.videoDetailPageLink||"vdp/"+l+b.celQueryStringParam,asin:f.asin||"",vendorTrackingId:f.vendorTrackingId||"",relatedProductsAsins:f.relatedProductsAsins||"",closedCaptions:f.closedCaptions||"",creatorType:f.creatorType||"",publicName:f.publicName||"",profileLink:f.profileLink||"",profileImageUrl:f.profileImageUrl||
"",rankingStrategy:f.rankingStrategy||"",aciContentId:f.csaCItemId||"",videoMimeType:f.videoMimeType||"",entityId:f.entityId||"",entityType:f.entityType||"",videoImageHeight:f.videoImageHeight||"",videoImageWidth:f.videoImageWidth||"",videoImagePhysicalId:f.videoImagePhysicalId||"",videoImageExtension:f.videoImageExtension||"",groupType:f.groupType||"",source:f.source||"",highlightedAsin:f.highlightedAsin||""},impressionRecorded:!1,lastPlayingTimestamp:0,index:k,htmlEl:h};"true"===f.isSponsoredBrandVideo&&
(h=h.querySelectorAll("."+e.vseSbVideoDataItem)[0])&&(h={adFeedbackUrl:h.dataset.adFeedbackUrl||"",clickTrackerUrl:h.dataset.clickTrackerUrl||"",instrumentationPixelUrl:h.dataset.instrumentationPixelUrl||"",trackingPixelUrl:h.dataset.trackingPixelUrl||"",linkUrl:h.dataset.linkUrl||"",isSponsoredBrandVideo:f.isSponsoredBrandVideo,videoDetailPageLink:f.vdpUrl||""},l.metadata=B.__assign(B.__assign({},l.metadata),h));g.push(l);k=H["default"].cardRoot.getElementsByClassName(e.vseVideoDataItem)[k];try{f.profileLink&&
f.profileImageUrl&&k&&za(k,k.querySelector("."+e.vseProfilePlaceholder),e.vseVideoThumbnailProfile)}catch(n){v("Exception has occurred while initializing profiles. Exception details: "+n,"ERROR"),q("profileInitializationFailure",1)}try{""!==f.disclosureText&&""!==f.disclosureLink&&k&&za(k,k.querySelector("."+e.vseVideoCreatorContainer),e.vseVideoDisclosure)}catch(n){v("Exception has occurred while moving the disclosure link. Exception details: "+n,"ERROR"),q("moveDisclosureElementFailure",1)}}});
return g},za=function(a,b,e){a=a.querySelector("."+e);b&&a&&a.parentNode&&(b.appendChild(a.cloneNode(!0)),a.parentNode.removeChild(a),(b=b.querySelector("."+e))&&b.classList.remove("aok-hidden"))},Aa=function(a,b){void 0===b&&(b=!1);var e=O["default"].innerHeight*(400<=a.height()?.1:.2),g=O["default"].innerHeight-a.height()-e;b?(b=Math.round(.5*a.height()),a=fb["default"].onScreen(a,b)):a=O["default"].scrollY+g>=a.offset().top&&O["default"].scrollY+e<=a.offset().top;return a},X=function(){return O["default"].innerWidth>
O["default"].innerHeight},A,Y=!1,Ba,fa,D,w,P,ha=!1,ia,V,Q,E,K,L,M,Z=!1,Ca=!0,Da=!1,ja,ka=0,aa,Ea=null,sb=function(a,b,e,g,h,k,l,f){void 0===h&&(h=!1);void 0===k&&(k=!0);void 0===l&&(l=!1);void 0===f&&(f=void 0);return B.__awaiter(void 0,void 0,void 0,function(){var n,r,t;return B.__generator(this,function(u){try{P=e;w=b;D=a;Z=h;Ca=k;Da=l;n=c["default"].now();ua={schemaId:"vse.VSECardsEvents.7",producerId:"vsemetrics_widgetcards",requiredNumOfFields:13};L=H["default"].cardRoot.getElementsByClassName(w.vseVideoDataItem);
if(!L)return q("noCardsIngressDom"),R(),[2];0<c["default"].$(".vse-video-thumbnail-wrapper .vse-video-thumbnail-preview").length&&(aa=c["default"].$(".vse-video-thumbnail-wrapper .vse-video-thumbnail-preview"),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,la),la());if((r=H["default"].cardRoot.getElementsByClassName(w.vseWidgetPageState))&&r[0]&&r[0].dataset){K=r[0].dataset;A=ea(L,K,w);u=K;var J=f,z,m,p,C;void 0===J&&(J="vse_cards");d.deviceType=D?"Mobile":"Desktop";d.pageType=u.client||
"Gateway";d.clientName=null!==(z=u.clientName)&&void 0!==z?z:"";var I;(I=null===(m=u.clientPrefix)||void 0===m?void 0:m.toLowerCase())||(I="IVE_VFTP"==d.clientName?d.clientName.toLowerCase():d.pageType.toLowerCase());d.clientPrefix=I;d.placement=(""!==d.clientName?d.clientName:d.pageType)+"Card-"+d.deviceType;d.metricsPlacement=(c["default"].capabilities.mobile?c["default"].capabilities.isAmazonApp?"mobile_app":"mobile_web":c["default"].capabilities.tablet?c["default"].capabilities.isAmazonApp?"tablet_app":
"tablet_web":"desktop_web")+"."+d.placement+"."+J;d.cardId=null!==(p=u.cardId)&&void 0!==p?p:"";d.creativeId=null!==(C=u.creativeId)&&void 0!==C?C:"";d.requester=u.requester||"VSEWidgetCards";d.enableMultipleImpressions="T1"===u.enableMultipleImpressions;ia="vse-component-feed-carousel-"+d.cardId;Q="vse-widget-popover-"+d.cardId;if(!c["default"].capabilities.video)return q("videoNotSupported"),[2];F("cardWidgetRendered");var S=A[0].productAsin?A[0].productAsin:"";d.buildCsmPayload=gb({placementContext:d.metricsPlacement,
clientId:"VSE",eventSource:"VSEWidgetCards",stringPayload:null!==S&&void 0!==S?S:"",creativeId:d.creativeId});if(D||"Detail"===d.pageType)wa(n,A,g);else{c["default"].$("."+d.cardId+" [class*=vsePlaceholder] .a-fixed-right-grid-inner").addClass(w.vseNoRightPadding);z=n;try{Fa(z,g,"vse-carousel-items-added-"+ia),Fa(z,g,"vse:cards:"+d.clientPrefix+":quad:ready")}catch(T){ma(T)}c["default"].trigger("vse-card-ready-"+ia)}(t=c["default"].capabilities.isAmazonApp&&c["default"].capabilities.android&&(c["default"].capabilities.androidVersion+
"").startsWith("8"))?(q("useMshopAutoplayFallback"),R()):(nb(),ob(),pb(),qb(),rb());"gatewayquad"===d.clientPrefix&&c["default"].trigger("vse:cards:"+d.clientPrefix+":quad:ready");Z&&(Ga(null,c["default"].now()),Ha())}else q("pageStateNotFound"),R()}catch(T){v("fatal exception has occurred. Exception details: "+T,"FATAL"),q("widgetFatalException"),R()}return[2]})})},Fa=function(a,b,e){c["default"].off(e);c["default"].on(e,function(){Y||(Y=!0,A=ea(L,K,w),wa(a,A,b))})},ob=function(a){void 0===a&&(a=
"click touch");c["default"].declarative("vse-widget-carousel-see-more-"+d.cardId,a,function(){return Ia()});c["default"].declarative("vse-widget-carousel-custom-action-"+d.cardId,a,function(b){var e;(b=null===(e=b.data)||void 0===e?void 0:e.link)?(Ja("widgetCustomActionClicked"),ta["default"].setLocation(b)):Ia()})},Ia=function(){D&&(ha=!0);c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").find(".vse-carousel-item").first().click();Ja("seeMoreLinkClicked")},Ja=function(a){F(a);a=d.buildCsmPayload({eventName:d.clientPrefix+
":"+a,intPayload:1});y(a)},pb=function(){var a=0;c["default"].off("a:popover:afterShow:vse-widget-popover-"+d.cardId);c["default"].on("a:popover:afterShow:vse-widget-popover-"+d.cardId,function(b){try{if(c["default"].$(b.popover.$popover).addClass(c["default"].$("#"+Q).data("cssClass")),a++,fa=!0,1===a){c["default"].$(b.popover.$popover).addClass(w.vseVerticalLightbox);var e=c["default"].now();E&&E.refresh();Z?(c["default"].$(b.popover.$popover).addClass(w.vseRemoveAbsolute),na()):(Ga(b.popover.$popover,
e),Ha())}else na()}catch(g){ma(g)}})},Ga=function(a,b){c["default"].on(d.clientPrefix+":vse:player:registered",function(){c["default"].$("#"+Q+" [class*=_vseWidgetLbVideoBlock_]").first().animate({opacity:1});if(fa){na();c["default"].$(a).addClass(w.vseRemoveAbsolute);var e=c["default"].now()-b;F("cardWidgetPopoverContentWaitTime",e)}});c["default"].on("vse:cards:"+d.clientPrefix+":componentbuilder:failed",function(){Ka();E?E.hide():c["default"].trigger("vse:cards:"+d.cardId+":secondary:view:close");
Z||c["default"].delay(function(){ta["default"].setLocation(M.videoDetailPageLink)},500)})},na=function(){ha&&c["default"].trigger("vse:"+d.clientPrefix+":page:watchAllClicked");ha=!1;var a={assetSpec:M,lightBoxId:""+Q};!0===Da&&Ea!==M.contentId&&(Ea=M.contentId,a.lazyLoadProductAsin=M.productAsin);c["default"].trigger("vse:"+d.clientPrefix+":page:lightBoxOpened",a);a=c["default"].$("#"+Q+" [class*=_vseWidgetLbVideoBlock_]");0<a.length&&(V=a.get(0),null!=P&&(tb(V),P.elect(V)))},qb=function(){c["default"].off("a:popover:beforeHide:vse-widget-popover-"+
d.cardId);c["default"].on("a:popover:beforeHide:vse-widget-popover-"+d.cardId,function(){fa=!1;Ba?(c["default"].trigger("vse:"+d.clientPrefix+":page:lightBoxClosed"),null!=P&&V&&P.unsubscribe(V)):F("cardWidgetLBClosedBeforeAjax")})},Ha=function(){mb(A,M,K,function(a){Ba=!0;q("preloadSuccess");c["default"].$("#"+Q+" [class*=_vseWidgetLbVideoBlock_]").html(a.responseBody)},function(a){c["default"].trigger("vse:cards:"+d.clientPrefix+":componentbuilder:failed");F("preloadFailed");q("preloadFailed:"+
a.statusCode);v("NilgiriService componentbuilder call has failed.\n        Status code: "+a.statusCode+". Status text: "+a.statusText,"FATAL");R()},Ca)},R=function(){var a=H["default"].cardRoot.getElementsByClassName(w.vseSeeMoreLink)[0];a&&a.classList&&a.classList.add("aok-hidden")},nb=function(){try{[].forEach.call(L,function(a){a.children[0].removeAttribute("target")}),La(),c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").delegate(".vse-carousel-item","click",function(a){Y||(A=ea(L,
K,w),Y=!0);if(!c["default"].$(a.target).closest("."+w.vseProfilePlaceholder).length){a.preventDefault();var b=c["default"].$(a.currentTarget);a=b.closest("li").index();var e=A[a];e.metadata&&(M=xa(e,b),b=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetClicked",intPayload:1,videoAsin:e.contentId,rankingStrategy:e.metadata.rankingStrategy}),F("cardWidgetClicked"),y(b),lb(a,K.celQueryStringParam),D?c["default"].trigger("vse:cards:"+d.cardId+":secondary:view:open"):(E=cb["default"].get(c["default"].$("."+
d.cardId+" #vse-widget-popover-trigger")),c["default"].objectIsEmpty(E)?q("lbNotFoundDesktop"):E.show()))}})}catch(a){ma(a)}},ma=function(a){v("fatal exception has occurred in LB. Exception details: "+a,"FATAL");q("lightboxOpenFatalException");R();Ka();E&&E.hide()},Ka=function(){La();[].forEach.call(L,function(a,b){a.children&&a.children[0]&&a.children[0].setAttribute("target",A[b].metadata.videoDetailPageLink)})},La=function(){c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").undelegate(".vse-carousel-item",
"click")},tb=function(a){P.subscribe(a,function(b){},{buffer:0})},rb=function(){c["default"].on(d.clientPrefix+"-leave-pip",function(a){c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel .vse-carousel-item")[a.index].click()})},Ma=function(a,b){ja[b]||(a=d.buildCsmPayload({eventName:d.clientPrefix+":thumbnailPreviewPlaybackStart",intPayload:b,videoAsin:a}),void 0!==a&&null!==a&&(y(a),ja[b]=!0))},la=function(){c["default"].onScreen(c["default"].$(".vse-video-thumbnail-wrapper"),100)&&(c["default"].each(aa,
function(a){var b=a.getAttribute("data-src");var e=void 0;void 0===e&&(e=1);e=3*(e-1);b=b.split(",")[e];a.src=b;a.addEventListener("ended",ub)}),c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,la),ja=Array(aa.length).fill(!1),D||vb(),wb(),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,W),W())},vb=function(){c["default"].$(".vse-video-widget-container").delegate(".vse-desktop-carousel-card","mouseenter",function(){ba();var a=c["default"].$(this).find("video"),b=c["default"].$(this).find(".vse-video-thumbnail-img");
Na(b);0<a.length&&(a[0].play(),b=c["default"].$(this).closest("li").index(),Ma(a[0].getAttribute("data-video-asin"),b),ka=0)});c["default"].$(".vse-video-widget-container").delegate(".vse-desktop-carousel-card","mouseleave",function(){var a=c["default"].$(this).find(".vse-video-thumbnail-img");oa(a);a=c["default"].$(this).find("video");0<a.length&&pa(a[0])})},oa=function(a){a&&0<a.length&&c["default"].fadeIn(a,300,"ease-in")},Na=function(a){a&&0<a.length&&c["default"].fadeOut(a,300,"ease-in")},Oa=
function(a){a=c["default"].$(".vse-video-widget-container ol li").eq(a);if(!a||0!=a.length)return c["default"].$(a).find("video")[0]},Pa=function(a){a=c["default"].$(".vse-video-widget-container ol li").eq(a);if(!a||0!=a.length)return c["default"].$(a).find(".vse-video-thumbnail-img")},ra=function(a){var b=Oa(a);if(b){var e=Pa(a);Na(e);b.play().then().catch(function(){c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,W);c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,qa);
ba(!0)});ka=a;Ma(b.getAttribute("data-video-asin"),a)}},W=function(){var a=c["default"].$(".vse-video-widget-container");if(0<a.length&&(!X()&&c["default"].onScreen(a)&&Aa(a)||X()&&c["default"].onScreen(a))){c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,W);c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,qa);a=D?Qa():ka;var b=Oa(a);if(!b||b.paused)ba(),ra(a)}},qa=function(){var a=c["default"].$(".vse-video-widget-container");0!=a.length&&(!Aa(a)&&!X()||X()&&!c["default"].onScreen(a))&&
(c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,W),c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,qa))},ba=function(a){void 0===a&&(a=!1);c["default"].each(aa,function(b){if(0!==b.currentTime||a){var e=c["default"].$(b).closest(".vse-video-thumbnail-wrapper").find(".vse-video-thumbnail-img");oa(e);pa(b)}})},pa=function(a){setTimeout(function(){a.currentTime=0;a.load()},300)},Qa=function(){var a=0;try{var b=c["default"].$(".vse-video-widget-container"),e=parseInt(b.find("li").css("width").replace("px",
""))+8,g=b.find("ol").css("-webkit-transform").split(/[()]/)[1],h=Math.abs(parseInt(g.split(",")[4]));a=Math.round(h/e)}catch(k){v("Error has occurred while finding the current focussed Element. Exception details: "+k,"ERROR")}return a},ub=function(a){try{var b=a.target.closest("li");pa(a.target);var e=c["default"].$(b).index()+1;a=0;try{var g=c["default"].$(".vse-video-widget-container"),h=parseInt(g.find("li").css("width").replace("px","")),k=D?c["default"].$(window).width():c["default"].$(".vse-video-widget-container .a-carousel-viewport").width();
a=Math.floor(k/(h+8))}catch(t){v("Error has occurred while finding the no of Thumbnails on screen. Exception details: "+t,"ERROR")}var l=a;var f=Math.ceil(e/l),n=Math.ceil((e+1)/l),r=Pa(e-1);oa(r);f===n&&ra(e)}catch(t){v("Error has occurred while playing the next preview. Exception details: "+t,"ERROR")}},wb=function(){var a=c["default"].$(".vse-cards-carousel-container");eb["default"].getCarousel(a).on("change:pageNumber",function(){ba();setTimeout(function(){ra(Qa())},D?100:310)})},xb=function(a){var b=
c["default"].capabilities.mobile;return{carouselItemClassName:a.carouselElement,widgetMetricsHandler:function(e,g){var h=c["default"].throttle(function(){e()},500,{leading:!1});c["default"].on(c["default"].constants.BROWSER_EVENTS.RESIZE,function(){e()});c["default"].$("."+d.cardId+" .a-carousel-goto-prevpage").click(function(){g("left");h()});c["default"].$("."+d.cardId+" .a-carousel-goto-nextpage").click(function(){g("right");h()});b&&(c["default"].off("a:carousel:vse-cards-vw-dp:change:pageNumber"),
c["default"].on("a:carousel:vse-cards-vw-dp:change:pageNumber",h))}}},N={thumbnailUpdates:"_vse-vw-dp-card_style_thumbnailUpdates__3sx2a",vseVideoImageWrapper:"_vse-vw-dp-card_style_vseVideoImageWrapper__3Sk54",vseCarouselItem:"_vse-vw-dp-card_style_vseCarouselItem__3IvFU",vseCarouselItemHovering:"_vse-vw-dp-card_style_vseCarouselItemHovering__3nydI",vseHoverSection:"_vse-vw-dp-card_style_vseHoverSection__1n4YC",carouselElement:"_vse-vw-dp-card_style_carouselElement__AVBU9",vseMobileVideoWidget:"_vse-vw-dp-card_style_vseMobileVideoWidget__17sDD",
vseDesktopCarousel:"_vse-vw-dp-card_style_vseDesktopCarousel__1UwLK",vseVideoDuration:"_vse-vw-dp-card_style_vseVideoDuration__vDK4S",vseVideoTitle:"_vse-vw-dp-card_style_vseVideoTitle__sPgV5",vseVideoTitleBlockOverlay:"_vse-vw-dp-card_style_vseVideoTitleBlockOverlay__ZyhF4",vseThumbnailSecondaryImg:"_vse-vw-dp-card_style_vseThumbnailSecondaryImg__2eoNE",vseVideoTitleBlock:"_vse-vw-dp-card_style_vseVideoTitleBlock__Qp7Od",vseVideoTitleText:"_vse-vw-dp-card_style_vseVideoTitleText__1lJWI",vseVideoTitleWithCreator:"_vse-vw-dp-card_style_vseVideoTitleWithCreator__1Meqf",
vseHasProfile:"_vse-vw-dp-card_style_vseHasProfile__28XGY",vseVideoCreatorName:"_vse-vw-dp-card_style_vseVideoCreatorName__3M1B_",vseProfilePlaceholder:"_vse-vw-dp-card_style_vseProfilePlaceholder__34FkJ",vseVideoThumbnailProfile:"_vse-vw-dp-card_style_vseVideoThumbnailProfile__1TFKR",vseLazyLoadSpinner:"_vse-vw-dp-card_style_vseLazyLoadSpinner__2XtFC",vseVideoSegmentHeader:"_vse-vw-dp-card_style_vseVideoSegmentHeader__14ouc",vseFirstItem:"_vse-vw-dp-card_style_vseFirstItem__3h4BK",vseVideoWidgetHeaderBlock:"_vse-vw-dp-card_style_vseVideoWidgetHeaderBlock__2t4B0",
vseVideoWidgetHeader:"_vse-vw-dp-card_style_vseVideoWidgetHeader__30B2I",vseWidgetPageState:"_vse-vw-dp-card_style_vseWidgetPageState__2eblq",vseVideoWidgetContainer:"_vse-vw-dp-card_style_vseVideoWidgetContainer__3HDIT",vseIngressCarousel:"_vse-vw-dp-card_style_vseIngressCarousel__2Knkb",vseThumbnailPreviewImg:"_vse-vw-dp-card_style_vseThumbnailPreviewImg__3dlho",vseCardsVideoThumbnail:"_vse-vw-dp-card_style_vseCardsVideoThumbnail__3xlzJ",vseWidgetLbVideoBlock:"_vse-vw-dp-card_style_vseWidgetLbVideoBlock__VfqBF",
vseWidgetLbVideoBlockWrapper:"_vse-vw-dp-card_style_vseWidgetLbVideoBlockWrapper__v6yOr",vseWidgetLbAbsolute:"_vse-vw-dp-card_style_vseWidgetLbAbsolute__bgBq7",vseWidgetLbSpinner:"_vse-vw-dp-card_style_vseWidgetLbSpinner__yjdTV",vseVerticalLightbox:"_vse-vw-dp-card_style_vseVerticalLightbox__12YT2",vseRemoveAbsolute:"_vse-vw-dp-card_style_vseRemoveAbsolute__2xmeK",vseUploadButton:"_vse-vw-dp-card_style_vseUploadButton__5QCM8",vseUploadButtonIcon:"_vse-vw-dp-card_style_vseUploadButtonIcon__2-eZR",
vseVideoDataItem:"_vse-vw-dp-card_style_vseVideoDataItem__2A7tm",vseVwdpWidgetPageState:"_vse-vw-dp-card_style_vseVwdpWidgetPageState__283lp",vseSbVideoDataItem:"_vse-vw-dp-card_style_vseSbVideoDataItem__1TmVd",thumbnailPreviewWrap:"_vse-vw-dp-card_style_thumbnailPreviewWrap__2sqTc",vseSearchVideosInput:"_vse-vw-dp-card_style_vseSearchVideosInput__2CfoS",videoPreviewWrapper:"_vse-vw-dp-card_style_videoPreviewWrapper__vvNVU",clearSearchInput:"_vse-vw-dp-card_style_clearSearchInput__3ZK67",sponsoredVideoLabel:"_vse-vw-dp-card_style_sponsoredVideoLabel__23SsR"};
sa._operationNames=[];sa.card=function(){return B.__awaiter(void 0,void 0,void 0,function(){var a,b,e,g,h,k,l,f,n;return B.__generator(this,function(r){switch(r.label){case 0:a=[".vse-segment-title-RVS_G1",".vse-segment-title-RVS_G2",".vse-segment-title-RVS_G1_T1",".vse-segment-title-RVS_G2_T1"];a.forEach(function(t){c["default"].$(".vse-video-widget-dp-container ."+N.vseVideoDataItem).find(""+t).first().addClass(N.vseFirstItem)});b=c["default"].capabilities.mobile;e=xb(N);if(c["default"].capabilities.mobile&&
c["default"].capabilities.isAmazonApp&&(g=H["default"].cardRoot.getElementsByClassName(N.vseVwdpWidgetPageState))&&g[0]&&g[0].dataset){h=g[0].dataset.searchAllVideosTreatment||"C";try{ab["default"].trigger("VSE_VWDP_SEARCHBAR_571449",h),"T1"===h&&(c["default"].$("."+N.vseSearchVideosInput).removeClass("aok-hidden"),k=H["default"].cardRoot.getElementsByTagName("form")[0],l=k.getElementsByTagName("input")[0],l.addEventListener("focus",function(){c["default"].trigger("vse:detail:searchform:focus")}),
f=H["default"].cardRoot.getElementsByClassName(N.clearSearchInput)[0],n=function(){""!==l.value?f.classList.remove("aok-hidden"):f.classList.add("aok-hidden")},l.addEventListener("keyup",n),n(),f.addEventListener("click",function(){l.value="";n();l.focus()}))}catch(t){v("Issue with VWDP Search form: "+t,"ERROR")}}return[4,sb(b,N,null,e,!0,!0)];case 1:return r.sent(),[2]}})})}});
