(function(c){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,b=f?f("ARARegisterTrigger",""):d;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,d,f){c.now("ARAConfiguration").execute(function(b){b||c.register("ARAConfiguration",function(){return{getRoboticSessionId:function(){return"000-0000000-0000000"},getUserAgent:function(){return navigator.userAgent}}})});"use strict";c.now("ARAAddMetric").execute(function(b){b||c.register("ARAAddMetric",
function(){return{addMetric:function(a,e){d.ue&&d.ue.count&&d.ue.count(a,e)}}})});"use strict";c.now("ARALogError").execute(function(b){b||c.register("ARALogError",function(){return{logError:function(a){var e={logLevel:2<arguments.length&&arguments[2]!==f?arguments[2]:"ERROR",attribution:"ARARegisterTrigger",message:1<arguments.length&&arguments[1]!==f?arguments[1]:""};d.ueLogError&&d.ueLogError(a,e);return[a,e]}}})});"use strict";c.now("ARAUtils").execute(function(b){b||c.register("ARAUtils",function(){function a(){return d.opts}
var e=/development|beta/,b=/pre-prod|gamma/,k={"Google Chrome":106};return{getWindowOpts:a,getHref:function(){return d.location.href},getStage:function(a){return e.test(a)?"beta":b.test(a)?"gamma":"prod"},getCustomerId:function(){return a().customerId},getSessionId:function(){return a().sessionId},getNavigator:function(){return navigator},registerFetch:function(a){return d.fetch(a,{keepalive:!0,attributionReporting:{eventSourceEligible:!1,triggerEligible:!0}})},checkIsBrowserSupported:function(){var a=
navigator.userAgentData;if(null==a)return!1;a=a.brands;a:{if(a&&0!==a.length){var e=!0,b=!1,c=f;try{for(var g=a[Symbol.iterator](),h;!(e=(h=g.next()).done);e=!0){var d=h.value;if(Number.parseFloat(d.version)>=k[d.brand]){var m=!0;break a}}}catch(p){b=!0,c=p}finally{try{!e&&g.return&&g.return()}finally{if(b)throw c;}}}m=!1}return m},checkIsFeatureAllowed:function(){return"featurePolicy"in document&&"function"===typeof document.featurePolicy.allowsFeature?document.featurePolicy.allowsFeature("attribution-reporting"):
!1}}})});"use strict";c.now("ARARegisterTriggerHelpers").execute(function(b){b||c.when("ARAConfiguration","ARAAddMetric","ARALogError","ARAUtils").register("ARARegisterTriggerHelpers",function(a,e,b,c){function d(a){switch(a){case "beta":return"https://us-east-1.beta.ara.advertising.amazon.dev";case "gamma":return"https://us-east-1.gamma.ara.advertising.amazon.dev";case "prod":return"https://us-east-1.ara.advertising.amazon.dev"}}function h(a,d,g,k){return c.registerFetch(a).then(function(b){if(d<
g)return b.ok?(e.addMetric("ARA:RegisterDPVResponseRecieved",1),b.json()):new Promise(function(b,e){setTimeout(function(){h(a,d+1,g,2*k).then(b).catch(e)},k)});throw Error("Exceeded maximum retries");}).catch(function(a){e.addMetric("ARA:RegisterDPVResponseError",1);b.logError(a,"ARA:RegisterDPVResponseError. Error receiving response from ARAService")})}return{generateGatewayUrl:d,browserSupportsARA:function(){var a=!0,b=c.checkIsBrowserSupported();b||e.addMetric("ARA:UserAgentNotSupported",1);var d=
c.checkIsFeatureAllowed();d||e.addMetric("ARA:ARAFeatureNotEnabled",1);b&&d||(a=!1);return a},registerTrigger:h,createQueryParams:function(a,b){b=d(b)+"/conversion?";var e={asin:a.pageInformation.asin,eventType:"dpv",debugKey:a.identity.customerId,marketId:1,requestId:a.identity.requestId},c=encodeURIComponent;a=Object.keys(e).map(function(a){return c(a)+"\x3d"+c(e[a])}).join("\x26");return b+a}}})});"use strict";c.now("DetailedPageInfo").execute(function(b){b||(c.register("DetailedPageInfo",function(){var a=
{init:function(b,c,d,f,l){a.config=b;a.helpers=f;a.utils=l;a.metrics=c;a.errors=d;b=a.config.getRoboticSessionId();(c=a.utils.getHref())?(c=a.utils.getStage(c),a.retrieveDPV(c,b)):(a.metrics.addMetric("ARA:PageLoadError",1),a.errors.logError({message:"ARA:PageLoadError. Error retrieving url from window."}))},retrieveDPV:function(b,c){if(a.helpers.browserSupportsARA()){a.metrics.addMetric("ARA:BrowserSupportsARA:True",1);var d=a.utils.getWindowOpts();if(d){b=a.utils.getSessionId();var e=d.pageType,
f=a.utils.getCustomerId(),h=d.obfuscatedMarketId,n=d.asin,g=a.utils.getHref();d=d.requestId;(c=b===c)?a.metrics.addMetric("ARA:TotalPunts",1):(b=a.helpers.createQueryParams({identity:{sessionId:b,customerId:f,requestId:d},pageInformation:{pageURL:g,pageType:e,asin:n,obfuscatedMarketId:h}},"gamma"),a.helpers.registerTrigger(b,0,5,100),a.metrics.addMetric("ARA:BrowserSupportsARA:DPV",1));c&&a.metrics.addMetric("ARA:RoboticTraffic:True",1)}else a.metrics.addMetric("ARA:OptsNotFoundError",1),a.errors.logError({message:"ARA:OptsNotFoundError. Error getting windowOpts."})}else a.metrics.addMetric("ARA:BrowserSupportsARA:False",
1)}};return a}),c.when("ARAConfiguration","ARAAddMetric","ARALogError","ARARegisterTriggerHelpers","ARAUtils","DetailedPageInfo","ready").execute(function(a,b,c,d,f,l){l.init(a,b,c,d,f)}))})});